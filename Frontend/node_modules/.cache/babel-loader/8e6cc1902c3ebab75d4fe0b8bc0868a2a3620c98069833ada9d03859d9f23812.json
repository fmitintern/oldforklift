{"ast":null,"code":"import axios from \"axios\";\nimport { io } from \"socket.io-client\";\nconst BASE_URL = \"http://144.11.1.83:5000/api\";\nconst SOCKET_URL = \"http://144.11.1.83:5000\";\n\n// âœ… Initialize WebSocket Connection\nconst socket = io(SOCKET_URL, {\n  reconnectionAttempts: 5,\n  // Auto-reconnect up to 5 times\n  timeout: 5000 // 5 seconds timeout\n});\n\n// âœ… Helper Function for API Requests\nconst apiRequest = async (method, endpoint, data = null) => {\n  try {\n    const response = await axios({\n      method,\n      url: `${BASE_URL}${endpoint}`,\n      data\n    });\n    return response.data;\n  } catch (error) {\n    var _error$response, _error$response2;\n    console.error(`âŒ API Error [${method.toUpperCase()} ${endpoint}]:`, ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error);\n    return {\n      error: ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data) || \"Request failed\"\n    };\n  }\n};\n\n// âœ… Fetch Active Ride\nexport const fetchActiveRide = userId => apiRequest(\"get\", `/tracking/ride-status/${userId}`);\n\n// âœ… Fetch Available Rides for Driver\n// export const fetchAdvanceRides = (driverId) => apiRequest(\"get\", `/bookings/available-rides/${driverId}`);\n\n// Add/update this function in api.js\nexport const submitMaintenanceRequest = requestData => apiRequest(\"post\", \"/requests/maintenance\", requestData);\n\n// âœ… Update Maintenance Status\nexport const updateMaintenanceStatus = (requestId, status, comment = null) => apiRequest(\"put\", `/maintenance/update-status/${requestId}`, {\n  status,\n  comment\n});\n\n// âœ… Book a Ride & Notify Drivers\nexport const bookRide = async (userId, fromLocation, toLocation, vehicleType, rideType = \"Regular\") => {\n  if (!userId || isNaN(userId)) return {\n    error: \"Invalid User ID\"\n  };\n  const response = await apiRequest(\"post\", \"/bookings/book-ride\", {\n    userId,\n    fromLocation,\n    toLocation,\n    vehicleType,\n    rideType,\n    isSpecialTask: rideType === \"Special Task\"\n  });\n  if (response !== null && response !== void 0 && response.rideId) {\n    socket.emit(\"newRideRequest\", {\n      ...response,\n      FROM_LOCATION: fromLocation,\n      TO_LOCATION: toLocation,\n      IS_SPECIAL_TASK: rideType === \"Special Task\"\n    });\n  }\n  return response;\n};\n\n// âœ… Accept a Ride & Notify Requester\nexport const acceptRide = async (driverId, rideId) => {\n  if (!driverId || !rideId) return {\n    error: \"Invalid parameters\"\n  };\n  const response = await apiRequest(\"post\", \"/bookings/accept-ride\", {\n    driverId,\n    rideId\n  });\n  if (response.success) socket.emit(\"acceptRide\", {\n    driverId,\n    rideId\n  });\n  return response;\n};\n\n// âœ… Start a Ride\nexport const startRide = rideId => apiRequest(\"post\", \"/tracking/start-ride\", {\n  rideId\n});\n\n// âœ… Mark Material Pick Time\nexport const markPickTime = rideId => apiRequest(\"post\", \"/tracking/mark-pick-time\", {\n  rideId\n});\n\n// âœ… Complete a Ride\nexport const completeRide = rideId => apiRequest(\"post\", \"/tracking/complete-ride\", {\n  rideId\n});\n\n// âœ… Fetch Maintenance Requests\nexport const fetchMaintenanceRequests = () => apiRequest(\"get\", \"/maintenance/issues\");\n\n// âœ… Report Maintenance Issue\nexport const reportMaintenance = (forkliftId, issue) => apiRequest(\"post\", \"/maintenance/report-maintenance\", {\n  forkliftId,\n  issue\n});\n\n// âœ… Resolve Maintenance Issue\nexport const resolveMaintenance = requestId => apiRequest(\"post\", \"/maintenance/resolve-maintenance\", {\n  requestId\n});\n\n// âœ… Fetch Ride Reports\nexport const fetchRideReports = () => apiRequest(\"get\", \"/reports/rides\");\n\n// âœ… Mark Driver as HOME\nexport const markHome = driverId => apiRequest(\"post\", \"/drivers/mark-home\", {\n  driverId\n});\n\n// âœ… WebSocket Event Listeners\nsocket.on(\"newRideRequest\", rideData => console.log(\"ðŸ“Œ New ride request:\", rideData));\nsocket.on(\"rideAccepted\", ({\n  rideId,\n  driverId\n}) => console.log(`âœ… Ride ${rideId} accepted by Driver ${driverId}`));\nsocket.on(\"driverStatusUpdated\", ({\n  driverId,\n  status\n}) => console.log(`ðŸ”„ Driver ${driverId} is now ${status}`));","map":{"version":3,"names":["axios","io","BASE_URL","SOCKET_URL","socket","reconnectionAttempts","timeout","apiRequest","method","endpoint","data","response","url","error","_error$response","_error$response2","console","toUpperCase","fetchActiveRide","userId","submitMaintenanceRequest","requestData","updateMaintenanceStatus","requestId","status","comment","bookRide","fromLocation","toLocation","vehicleType","rideType","isNaN","isSpecialTask","rideId","emit","FROM_LOCATION","TO_LOCATION","IS_SPECIAL_TASK","acceptRide","driverId","success","startRide","markPickTime","completeRide","fetchMaintenanceRequests","reportMaintenance","forkliftId","issue","resolveMaintenance","fetchRideReports","markHome","on","rideData","log"],"sources":["C:/Users/ksrvisitor/forklift/Frontend/src/Services/api.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nconst BASE_URL = \"http://144.11.1.83:5000/api\";\r\nconst SOCKET_URL = \"http://144.11.1.83:5000\";\r\n\r\n\r\n// âœ… Initialize WebSocket Connection\r\nconst socket = io(SOCKET_URL, {\r\n  reconnectionAttempts: 5, // Auto-reconnect up to 5 times\r\n  timeout: 5000, // 5 seconds timeout\r\n});\r\n\r\n// âœ… Helper Function for API Requests\r\nconst apiRequest = async (method, endpoint, data = null) => {\r\n  try {\r\n    const response = await axios({\r\n      method,\r\n      url: `${BASE_URL}${endpoint}`,\r\n      data,\r\n    });\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\r\n      `âŒ API Error [${method.toUpperCase()} ${endpoint}]:`,\r\n      error.response?.data || error\r\n    );\r\n    return { error: error.response?.data || \"Request failed\" };\r\n  }\r\n};\r\n\r\n// âœ… Fetch Active Ride\r\nexport const fetchActiveRide = (userId) =>\r\n  apiRequest(\"get\", `/tracking/ride-status/${userId}`);\r\n\r\n// âœ… Fetch Available Rides for Driver\r\n// export const fetchAdvanceRides = (driverId) => apiRequest(\"get\", `/bookings/available-rides/${driverId}`);\r\n\r\n// Add/update this function in api.js\r\nexport const submitMaintenanceRequest = (requestData) =>\r\n  apiRequest(\"post\", \"/requests/maintenance\", requestData);\r\n\r\n\r\n// âœ… Update Maintenance Status\r\nexport const updateMaintenanceStatus = (requestId, status, comment = null) =>\r\n  apiRequest(\"put\", `/maintenance/update-status/${requestId}`, { status, comment });\r\n\r\n// âœ… Book a Ride & Notify Drivers\r\nexport const bookRide = async (\r\n  userId,\r\n  fromLocation,\r\n  toLocation,\r\n  vehicleType,\r\n  rideType = \"Regular\"\r\n) => {\r\n  if (!userId || isNaN(userId)) return { error: \"Invalid User ID\" };\r\n\r\n  const response = await apiRequest(\"post\", \"/bookings/book-ride\", {\r\n    userId,\r\n    fromLocation,\r\n    toLocation,\r\n    vehicleType,\r\n    rideType,\r\n    isSpecialTask: rideType === \"Special Task\"\r\n  });\r\n\r\n  if (response?.rideId) {\r\n    socket.emit(\"newRideRequest\", {\r\n      ...response,\r\n      FROM_LOCATION: fromLocation,\r\n      TO_LOCATION: toLocation,\r\n      IS_SPECIAL_TASK: rideType === \"Special Task\"\r\n    });\r\n  }\r\n  return response;\r\n};\r\n\r\n// âœ… Accept a Ride & Notify Requester\r\nexport const acceptRide = async (driverId, rideId) => {\r\n  if (!driverId || !rideId) return { error: \"Invalid parameters\" };\r\n\r\n  const response = await apiRequest(\"post\", \"/bookings/accept-ride\", {\r\n    driverId,\r\n    rideId,\r\n  });\r\n  if (response.success) socket.emit(\"acceptRide\", { driverId, rideId });\r\n  return response;\r\n};\r\n\r\n// âœ… Start a Ride\r\nexport const startRide = (rideId) =>\r\n  apiRequest(\"post\", \"/tracking/start-ride\", { rideId });\r\n\r\n// âœ… Mark Material Pick Time\r\nexport const markPickTime = (rideId) =>\r\n  apiRequest(\"post\", \"/tracking/mark-pick-time\", { rideId });\r\n\r\n// âœ… Complete a Ride\r\nexport const completeRide = (rideId) =>\r\n  apiRequest(\"post\", \"/tracking/complete-ride\", { rideId });\r\n\r\n// âœ… Fetch Maintenance Requests\r\nexport const fetchMaintenanceRequests = () =>\r\n  apiRequest(\"get\", \"/maintenance/issues\");\r\n\r\n// âœ… Report Maintenance Issue\r\nexport const reportMaintenance = (forkliftId, issue) =>\r\n  apiRequest(\"post\", \"/maintenance/report-maintenance\", { forkliftId, issue });\r\n\r\n// âœ… Resolve Maintenance Issue\r\nexport const resolveMaintenance = (requestId) =>\r\n  apiRequest(\"post\", \"/maintenance/resolve-maintenance\", { requestId });\r\n\r\n// âœ… Fetch Ride Reports\r\nexport const fetchRideReports = () => apiRequest(\"get\", \"/reports/rides\");\r\n\r\n\r\n\r\n\r\n// âœ… Mark Driver as HOME\r\nexport const markHome = (driverId) =>\r\n  apiRequest(\"post\", \"/drivers/mark-home\", { driverId });\r\n\r\n// âœ… WebSocket Event Listeners\r\nsocket.on(\"newRideRequest\", (rideData) =>\r\n  console.log(\"ðŸ“Œ New ride request:\", rideData)\r\n);\r\nsocket.on(\"rideAccepted\", ({ rideId, driverId }) =>\r\n  console.log(`âœ… Ride ${rideId} accepted by Driver ${driverId}`)\r\n);\r\nsocket.on(\"driverStatusUpdated\", ({ driverId, status }) =>\r\n  console.log(`ðŸ”„ Driver ${driverId} is now ${status}`)\r\n);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}